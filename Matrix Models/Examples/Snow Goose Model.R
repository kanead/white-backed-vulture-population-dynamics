#################################################
# Snow Goose Model
#################################################
# clean everything first
rm(list=ls())

# load required packages
library(popbio)
library(diagram)
#################################################
# Average year #
#################################################
# Fecundity
# Fi = BP.(TCL/2).NS.P1.P2.P3.SA
BP2 <- 0.35
BP3 <- 0.77
BP4 <- 0.85
F2 <- BP2*(3.81/2)*0.71*0.905*0.93*0.705*0.83 
F3 <- BP3*(3.81/2)*0.71*0.905*0.93*0.705*0.83 
F4 <- BP4*(3.81/2)*0.71*0.905*0.93*0.705*0.83 
# Survival
S1 <- 0.35
SA <- 0.83
#################################################


#################################################
# Good year #
#################################################
# Fecundity
BP2 <- 0.35
BP3 <- 0.77
BP4 <- 0.85
F2 <- BP2*(4.44/2)*0.89*0.956*0.96*0.759*0.83 
F3 <- BP3*(4.44/2)*0.89*0.956*0.96*0.759*0.83 
F4 <- BP4*(4.44/2)*0.89*0.956*0.96*0.759*0.83 
# Survival
S1 <- 0.5
SA <- 0.83
#################################################

#################################################
# Bad year #
#################################################
# Fecundity
BP2 <- 0.35
BP3 <- 0.77
BP4 <- 0.85
F2 <- BP2*(3.39/2)*0.14*0.885*0.879*0.759*0.529 
F3 <- BP3*(3.39/2)*0.14*0.885*0.879*0.705*0.529 
F4 <- BP4*(3.39/2)*0.14*0.885*0.879*0.705*0.529 
# Survival
S1 <- 0.12
SA <- 0.83
#################################################

#################################################
# Post-breeding census
#################################################
A <- c(0,F2,F3,F4,
         S1,0,0,0,
         0,SA,0,0,
         0,0,SA,SA
)
A <- matrix ((A), ncol=4, byrow = TRUE)

N<-c(10,10,10,10)
N<-matrix (N, ncol=1)
N

# previous function is wrapped up into pop.projection
popModel <- pop.projection(A,N,iterations=100)

# Calculate population growth rate and other demographic parameters from a projection matrix model
# using matrix algebra
eigen.analysis(A, zero=TRUE)
